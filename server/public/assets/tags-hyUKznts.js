import{A as y,r as c,i as R,u as f}from"./index-CQ66hlSz.js";const N=y("recipes",()=>{const n=c([]),o=c(!1),t=c(null),s=c([]),g=c(null),v=R(()=>{let a=n.value;return s.value.length>0&&(a=n.value.filter(e=>!e.tags||e.tags.length===0?!1:s.value.every(l=>e.tags?.includes(l)))),[...a].sort((e,l)=>{const i=e.isFavorite?1:0;return(l.isFavorite?1:0)-i})});async function d(){const a=f();if(!a.isLoggedIn||!a.token){t.value="Nicht eingeloggt.",n.value=[];return}o.value=!0,t.value=null;try{const r=await fetch("https://localhost:8000/api/recipes",{method:"GET",headers:{Authorization:`Bearer ${a.token}`}});if(!r.ok){if(r.status===401)t.value="Sitzung abgelaufen, bitte neu einloggen.",a.logout(),n.value=[];else{const l=await r.json().catch(()=>({}));t.value=l.message||`Fehler beim Abrufen der Rezepte (${r.status})`,n.value=[]}o.value=!1;return}const e=await r.json();n.value=e,console.log("Rezepte erfolgreich geladen:",n.value)}catch(r){console.error("Netzwerkfehler beim Abrufen der Rezepte:",r),t.value="Netzwerkfehler oder Server nicht erreichbar.",n.value=[]}finally{o.value=!1}}async function p(a){const r=f();if(!r.isLoggedIn||!r.token)return t.value="Nicht eingeloggt. Rezept kann nicht gespeichert werden.",!1;o.value=!0,t.value=null;try{const e=await fetch("https://localhost:8000/api/recipes",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r.token}`},body:JSON.stringify(a)});if(!e.ok){if(e.status===401)t.value="Sitzung abgelaufen, bitte neu einloggen.",r.logout();else{const i=await e.json().catch(()=>({}));t.value=i.message||`Fehler beim Speichern (${e.status})`}return o.value=!1,!1}const l=await e.json();return n.value.unshift(l),console.log("Rezept erfolgreich gespeichert:",l),!0}catch(e){return console.error("Netzwerkfehler beim Speichern des Rezepts:",e),t.value="Netzwerkfehler oder Server nicht erreichbar.",!1}finally{o.value=!1}}async function k(a){const r=f();if(!r.isLoggedIn||!r.token)return t.value="Nicht eingeloggt. Rezept kann nicht gelöscht werden.",!1;o.value=!0,t.value=null;try{const e=await fetch(`https://localhost:8000/api/recipes/${a}`,{method:"DELETE",headers:{Authorization:`Bearer ${r.token}`}});if(!e.ok){if(e.status===401)t.value="Sitzung abgelaufen, bitte neu einloggen.",r.logout();else if(e.status===404)t.value="Rezept nicht gefunden oder bereits gelöscht.",n.value=n.value.filter(l=>l.id!==a);else{const l=await e.json().catch(()=>({}));t.value=l.message||`Fehler beim Löschen (${e.status})`}return!1}return n.value=n.value.filter(l=>l.id!==a),console.log(`Rezept ${a} lokal entfernt.`),!0}catch(e){return console.error("Netzwerkfehler beim Löschen des Rezepts:",e),t.value="Netzwerkfehler oder Server nicht erreichbar.",!1}finally{o.value=!1}}async function z(a,r){const e=f();if(!e.isLoggedIn||!e.token)return t.value="Nicht eingeloggt. Rezept kann nicht aktualisiert werden.",!1;o.value=!0,t.value=null;try{const l=await fetch(`https://localhost:8000/api/recipes/${a}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.token}`},body:JSON.stringify(r)});if(!l.ok){if(l.status===401)t.value="Sitzung abgelaufen, bitte neu einloggen.",e.logout();else if(l.status===404)t.value="Rezept nicht gefunden.";else{const h=await l.json().catch(()=>({}));t.value=h.message||`Fehler beim Aktualisieren (${l.status})`}return o.value=!1,!1}const i=await l.json(),u=n.value.findIndex(h=>h.id===a);return u!==-1?n.value[u]=i:n.value.unshift(i),console.log("Rezept erfolgreich aktualisiert:",i),!0}catch(l){return console.error("Netzwerkfehler beim Aktualisieren des Rezepts:",l),t.value="Netzwerkfehler oder Server nicht erreichbar.",!1}finally{o.value=!1}}async function b(a){const r=f();if(!r.isLoggedIn||!r.token)return t.value="Nicht eingeloggt.",!1;g.value=a,t.value=null;try{const e=await fetch(`https://localhost:8000/api/recipes/${a}/favorite`,{method:"PATCH",headers:{Authorization:`Bearer ${r.token}`}});if(!e.ok)return e.status===401?(t.value="Sitzung abgelaufen.",r.logout()):t.value=`Fehler beim Setzen des Favoriten-Status (${e.status})`,!1;const l=await e.json(),i=n.value.findIndex(u=>u.id===a);return i!==-1&&(n.value[i]=l),console.log(`Favoriten-Status für ${a} aktualisiert.`),!0}catch(e){return console.error("Netzwerkfehler beim Favoriten-Toggle:",e),t.value="Netzwerkfehler oder Server nicht erreichbar.",!1}finally{g.value=null}}function m(a){a&&!s.value.includes(a)&&s.value.push(a),console.log("Aktive Filter:",s.value)}function w(a){s.value=s.value.filter(r=>r!==a),console.log("Aktive Filter:",s.value)}function S(){s.value=[],console.log("Filter zurückgesetzt")}return{recipes:n,isLoading:o,error:t,fetchRecipes:d,addRecipe:p,deleteRecipeAction:k,updateRecipeAction:z,activeTagFilters:s,filteredRecipes:v,addTagFilter:m,removeTagFilter:w,clearTagFilters:S,togglingFavoriteId:g,toggleFavoriteAction:b}}),F=[{name:"schnell",colorClass:"tag-color-3"},{name:"vegetarisch",colorClass:"tag-color-4"},{name:"vegan",colorClass:"tag-color-2"},{name:"herzhaft",colorClass:"tag-color-5"},{name:"süß",colorClass:"tag-color-6"},{name:"getränk",colorClass:"tag-color-1"}];function T(n){const o=F.find(t=>t.name===n);return o?o.colorClass:"tag-color-1"}export{F as a,T as g,N as u};
